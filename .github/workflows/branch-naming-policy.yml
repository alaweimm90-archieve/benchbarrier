name: Branch Naming Policy

on:
  pull_request:
    types: [opened, edited, synchronize, reopened]

jobs:
  check-branch-name:
    runs-on: ubuntu-latest
    steps:
      - name: Check branch name convention
        run: |
          BRANCH_NAME="${{ github.head_ref }}"
          
          echo "üîç Checking branch name: $BRANCH_NAME"
          
          # Allow specific patterns
          if [[ $BRANCH_NAME =~ ^(feature|fix|hotfix|refactor|docs|test)/.+ ]]; then
            echo "‚úÖ Branch name is valid: $BRANCH_NAME"
            exit 0
          fi
          
          # Allow main and dev
          if [[ $BRANCH_NAME == "main" || $BRANCH_NAME == "dev" ]]; then
            echo "‚úÖ Core branch: $BRANCH_NAME"
            exit 0
          fi
          
          # Reject invalid names
          echo "‚ùå Invalid branch name: $BRANCH_NAME"
          echo ""
          echo "Branch names must follow this convention:"
          echo "  - feature/your-feature-name"
          echo "  - fix/bug-description"
          echo "  - hotfix/urgent-fix"
          echo "  - refactor/code-improvement"
          echo "  - docs/documentation-update"
          echo "  - test/test-addition"
          echo ""
          echo "Examples:"
          echo "  ‚úÖ feature/user-authentication"
          echo "  ‚úÖ fix/login-bug"
          echo "  ‚úÖ hotfix/security-patch"
          echo "  ‚ùå my-random-branch"
          echo "  ‚ùå copilot/sub-pr-3"
          echo ""
          exit 1
